function rescale(t,e,n,a,o){return a||(a=0),o||(o=1),(n-e)*(t-a)/(o-a)+e}function interleave(t,e){if(t.length!=e.length)throw"inputs must have the same length";C=new Array(2*t.length);for(let n=0;n<t.length;n++)C[2*n]=t[n],C[2*n+1]=e[n];return C}$(document).ready((()=>{let t=500,e=Math.sqrt(t)/2,n=[-e,-e,e,e],a=new VTPState(t,1,4),o=1;a.randomize(n),a.addTargetComponent([0,0]);const r=document.getElementById("canvas");let l,i;function s(){l||(l=setInterval((()=>{a.render(r,n.map((t=>t*o)))}),40))}function g(){i||(i=setInterval((()=>{a.step(),$("#treadout").html(a.iteration)}),40))}function c(){clearInterval(i),i=null}s();const d=$("#playbutton-cb");d.change((()=>{d.prop("checked")?(g(),running=!0):(c(),running=!1)})),$("#skipbutton").on("click",(()=>{running&&c(),clearInterval(l),l=null;for(let t=0;t<100;t++)a.step();$("#treadout").html(a.iteration),s(),running&&g()})),$("#zoomin").on("click",(()=>o/=1.1)),$("#zoomout").on("click",(()=>o*=1.1));const m=$("#modeltoggle-cb");m.change((()=>{m.prop("checked")?a.speedModel="leading straight cone":a.speedModel="leading geodesic"}));const h=$("#textField-N");h.val(a.numAgents),$("#nForm").submit((()=>{if(t=parseInt(h.val()),!isNaN(t)&&t>0){e=Math.sqrt(t)/2,n=[-e,-e,e,e];let r=a.alignmentStrength;a=new VTPState(t,1,r),a.randomize(n),a.addTargetComponent([0,0]),o=1,$("#Nreadout").html(t)}}));const u=$("#textField-nu");u.val(a.alignmentStrength),$("#alignmentStrengthForm").submit((()=>{const t=parseFloat(u.val());!isNaN(t)&&t>0&&(a.alignmentStrength=t,$("#nureadout").html(t))})),$("#target-options *").click((function(){let e=!1;i&&(c(),e=!0),a.clearTargets();switch($(this).attr("id")){case"single-point":a.addTargetComponent([0,0]);break;case"segment":a.addTargetComponent([-10,0,10,0]);break;case"cross":a.addTargetComponent([-10,-10,10,10],"+"),a.addTargetComponent([-10,10,10,-10],"-"),a.assignToTarget("+",0,Math.floor(t/2)),a.assignToTarget("-",Math.floor(t/2),t);break;case"ngon":let e=5;a.addTargetComponent(Array(2*e).fill(0).map(((t,n)=>n%2==0?5*Math.sin(n/2*2*Math.PI/e):5*Math.cos((n-1)/2*2*Math.PI/e))));break;case"nested-squares":a.addTargetComponent([-3,-3,3,-3,3,3,-3,3],"in"),a.addTargetComponent([-9,-9,9,-9,9,9,-9,9],"out"),a.assignToTarget("in",0,Math.floor(t/2)),a.assignToTarget("out",Math.floor(t/2),t)}e&&g()})),$("#export").on("click",(()=>{a.exportData()}))}));