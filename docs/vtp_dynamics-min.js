function rescale(t,e,n,a,o){return a||(a=0),o||(o=1),(n-e)*(t-a)/(o-a)+e}function interleave(t,e){if(t.length!=e.length)throw"inputs must have the same length";C=new Array(2*t.length);for(let n=0;n<t.length;n++)C[2*n]=t[n],C[2*n+1]=e[n];return C}$(document).ready((()=>{let t=500,e=Math.sqrt(t)/2,n=[-e,-e,e,e],a=new VTPState(t,1,10),o=1;a.randomize(n),a.addTargetComponent([0,0]);const l=document.getElementById("canvas");let r,i;function c(){r||(r=setInterval((()=>{a.render(l,n.map((t=>t*o)))}),40))}function g(){i||(i=setInterval((()=>{a.step(),$("#treadout").html(a.iteration)}),40))}function s(){clearInterval(i),i=null}c();const u=$("#playbutton-cb");u.change((()=>{u.prop("checked")?(g(),running=!0):(s(),running=!1)})),$("#skipbutton").on("click",(()=>{running&&s(),clearInterval(r),r=null;for(let t=0;t<100;t++)a.step();$("#treadout").html(a.iteration),c(),running&&g()})),$("#zoomin").on("click",(()=>o/=1.1)),$("#zoomout").on("click",(()=>o*=1.1));const d=$("#modeltoggle-cb");d.change((()=>{d.prop("checked")?a.speedModel="leading straight cone":a.speedModel="leading geodesic"}));const m=$("#textField-N");m.val(a.numAgents),$("#nForm").submit((()=>{if(t=parseInt(m.val()),!isNaN(t)&&t>0){e=Math.sqrt(t)/2,n=[-e,-e,e,e];let l=a.alignmentStrength;a=new VTPState(t,1,l),a.randomize(n),a.addTargetComponent([0,0]),o=1}}));const h=$("#textField-nu");h.val(a.alignmentStrength),$("#alignmentStrengthForm").submit((()=>{const t=parseFloat(h.val());!isNaN(t)&&t>0&&(a.alignmentStrength=t)})),$("#export").on("click",(()=>{a.exportData()}))}));